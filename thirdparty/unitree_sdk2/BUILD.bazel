hdrs = glob([
    "include/unitree/common/*.hpp",
    "include/unitree/common/**/*.hpp",
    "include/unitree/idl/*.hpp",
    "include/unitree/idl/**/*.hpp",
    "include/unitree/robot/*.hpp",
    "include/unitree/robot/**/*.hpp",
])

cc_import(
    name = "static_import_libunitree",
    hdrs = hdrs,
    includes = [
        "include",
    ],
    alwayslink = True,
    static_library = select({
        "@platforms//cpu:x86_64": "lib/x86_64/libunitree_sdk2.a",
        "@platforms//cpu:arm64": "lib/aarch64/libunitree_sdk2.a",
        "//conditions:default": "@platforms//:incompatible",
    }),

)

cc_library(
    name = "lib_unitree",
    hdrs = hdrs,
    includes = [
        "include",
    ],
    deps = [
        ":static_import_libunitree",
        "//thirdparty/cyclonedds:lib_ddsc",
        "//thirdparty/cyclonedds:lib_ddscxx",
    ],
    copts = ["-fpic"],
    linkopts = ["-pthread"],
    alwayslink = True,
    visibility = ["//visibility:public"],
)